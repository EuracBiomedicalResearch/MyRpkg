"0",""
"0","# library(kinship2)"
"0",""
"0","# 1 - subset CHRISMB only participants"
"0","CHRISMB_only_pedigree <- filter(CHRISMB_pedigree_extended, id %in% chrismb_aids)"
"0","# fix the HHID = """" problems"
"0","CHRISMB_only_pedigree$HHID <- ifelse(CHRISMB_only_pedigree$HHID == """", ""unknown"", CHRISMB_only_pedigree$HHID)"
"0","CHRISMB_only_pedigree$HHID <- ifelse(CHRISMB_only_pedigree$HHID == ""unknown"", make.unique(CHRISMB_only_pedigree$HHID), CHRISMB_only_pedigree$HHID)"
"0",""
"0","# 2 - make family name"
"0","CHRISMB_only_pedigree$fam <- as.character(kinship2::makefamid(id = CHRISMB_only_pedigree$id, mother.id = CHRISMB_only_pedigree$mo, father.id = CHRISMB_only_pedigree$fa))"
"0","# 2.1 - fix the 0 problem, that are singletons. rename them as unique"
"0","CHRISMB_only_pedigree$fam <- ifelse(CHRISMB_only_pedigree$fam == ""0"", make.unique(CHRISMB_only_pedigree$fam),CHRISMB_only_pedigree$fam) "
"0",""
"0","# 3 - fix parents in ""id"", only necessary if you want to plot. NB: don't do this before step 2, because the resulting family will be fully ""artificially"" connected"
"0","# CHRISMB_only_pedigree_fixed <- kinship2::fixParents(id = CHRISMB_only_pedigree$id, dadid = CHRISMB_only_pedigree$fa, momid = CHRISMB_only_pedigree$mo, sex = as.integer(CHRISMB_only_pedigree$sex)) "
"0","# important: so far i didn't make it work..."
"0",""
"0",""
"0","## EXTRA: Add pedigree to metadata"
"0",""
"0","CHRISMB_only_pedigree <- mutate(CHRISMB_only_pedigree, "
"0","                                HHID_fam = paste(HHID,fam, sep = ""_""),"
"0","                                aid_chris = id)"
"0",""
"0",""
"0","chrismb_phy_core_ped <- add_meta_variables(physeq = chrismb_phy_core, df = select(CHRISMB_only_pedigree, -sex), by = ""aid_chris"")"
"0",""
"0","## subset only those samples you are interested in, that are non-missing ones and those not taking antibiotics"
"0",""
"0","chrismb_phy_core_ped_selected_samples <- drop_NA_from_phyloseq_vars(chrismb_phy_core_ped, c(""HHID"", ""fam"", ""how_many_teeth"", ""smoking_exposure_ga"")) %>% subset_samples(used_antibiotics_last_3_months == ""no"")"
"1","dropping NAs from these variables:
"
"1","HHID   "
"1","fam   "
"1","how_many_teeth   "
"1","smoking_exposure_ga   "
"1","
"
